{"version":3,"file":"index.vue.mjs","sources":["../../../../../pages/produse/index.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen flex flex-col items-center  bg-gray-100\">\n    <div class=\"flex p-2 w-full md:w-full lg:w-[75vw]  flex-col  xs:flex-col  sm:flex-col sm:flex-row md:flex-row lg:flex-row sm:gap-4 md:gap-4 lg:gap-8  mt-2 md:mt-10 \">\n      <!-- Sidebar Filters -->\n      <aside class=\"w-full mb-5  sm:w-[30%] md:w-[25%] lg:w-[22%] shrink-0 space-y-6 bg-white p-4 rounded h-fit \">\n        <div class=\" sm:hidden h-[10px]  cursor-pointer\" @click=\"showFilters = !showFilters\">\n          <div class=\"flex justify-between items-center w-full h-[40px] \">\n            <h2 class=\"text-base font-semibold text-gray-800 flex items-center gap-2\">\n              <i class=\"fas fa-sliders-h text-sm\"></i> Filtrează\n            </h2>\n            <i :class=\"showFilters ? 'fas fa-chevron-up' : 'fas fa-chevron-down'\" class=\"text-xs text-gray-600\"></i>\n\n          </div>\n        </div>\n        <h2 class=\" hidden text-base font-semibold text-gray-800 sm:flex items-center gap-2\">\n          <i class=\"fas fa-sliders-h text-sm\"></i> Filtrează\n        </h2>\n        <div v-show=\"showFilters\" class=\"space-y-4 mt-10 sm:mt-0 transition-all duration-300 ease-in-out\">\n          <!-- Search -->\n          <div>\n            <label class=\"text-sm text-gray-600 font-medium\">Caută</label>\n            <input v-model=\"search\" type=\"text\" placeholder=\"Caută produse...\"\n              class=\"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm bg-white focus:outline-none focus:ring-2 focus:ring-cyan-600\" />\n          </div>\n\n          <!-- Max price -->\n          <div>\n            <label class=\"text-sm text-gray-600 font-medium\">Preț maxim</label>\n            <input v-model=\"maxPrice\" type=\"number\" min=\"0\" placeholder=\"Ex: 200\"\n              class=\"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm bg-white focus:outline-none focus:ring-2 focus:ring-cyan-600\" />\n          </div>\n\n          <!-- Categories -->\n          <div>\n            <div class=\"flex items-center justify-between mb-1\">\n              <h3 class=\"text-sm font-semibold text-gray-700\">Categorii</h3>\n              <button @click=\"resetFilters\" class=\"text-xs text-cyan-600 hover:underline\">Resetează</button>\n            </div>\n            <div class=\"space-y-1\">\n              <details v-for=\"(parentCat, index) in parentCategories\" :key=\"parentCat?.id\"\n                class=\"border border-gray-200 rounded-md overflow-hidden\">\n                <summary\n                  class=\"flex items-center justify-between cursor-pointer text-sm font-medium text-gray-700 px-3 py-2 hover:bg-gray-50\">\n                  {{ parentCat.name }}\n                  <span class=\"text-xs text-gray-400\">+</span>\n                </summary>\n                <div v-if=\"parentCat.children && parentCat.children[0]?.id !== null\" class=\"space-y-1 px-4 py-2\">\n                  <label v-for=\"child in parentCat.children\" :key=\"child.id\"\n                    class=\"flex items-center gap-2 text-sm text-gray-600\">\n                    <input type=\"checkbox\" :value=\"child.id\" v-model=\"selectedCategories\" class=\"accent-cyan-600\" />\n                    {{ child.name }}\n                  </label>\n                </div>\n                <div v-else class=\"px-4 py-2 text-sm text-gray-500\">Nicio subcategorie.</div>\n              </details>\n            </div>\n          </div>\n        </div>\n      </aside>\n\n      <!-- Products Grid -->\n      <div class=\" sm:w-full flex items-center  flex-col\">\n        <!-- Display error message if any -->\n        <div v-if=\"error\" class=\"text-red-500 text-center mb-4\">\n          {{ error }}\n        </div>\n        <div class=\"grid lg:w-[55vw] grid-cols-2 xs:grid-cols-3  sm:grid-cols-3 md:grid-cols-4 xl:grid-cols-5 gap-5\">\n          <div v-for=\"product in filteredProducts\" :key=\"product.id\"\n            class=\"bg-white mb-4 max-w-[170px] sm:max-w-full  rounded overflow-hidden shadow-sm hover:shadow-md transition duration-300 group \">\n            <div class=\"relative\">\n              <div>\n                <div v-if=\"Number(product.stock) === 0\"\n                  class=\"absolute top-0 left-0 bg-red-500 text-white text-xs font-semibold px-2 py-1 rounded-br-lg\">\n                  Stoc epuizat\n                </div>\n                <div v-else-if=\"Number(product.stock) > 1 && Number(product.stock) <=  10\"\n                  class=\"absolute top-0 left-0 bg-yellow-500 text-white text-xs font-semibold px-2 py-1 rounded-br-lg\">\n                  ultimele {{ product.stock }} produse\n                </div>\n                <div v-else-if=\"Number(product.stock) === 1 \"\n                  class=\"absolute top-0 left-0 bg-yellow-500 text-white text-xs font-semibold px-2 py-1 rounded-br-lg\">\n                  Ultimul produs\n                </div>\n              </div>\n              <div class=\"overflow-hidden \">\n                <img :src=\"getImage(product)\" :alt=\"product.name\"\n                  class=\"aspect-square object-cover w-full  transition-transform duration-300\" />\n              </div>\n              <div\n                class=\"mt-2 md:absolute md:mt-0 inset-0 flex items-center justify-center gap-3 md:opacity-0 md:group-hover:opacity-100 md:transition md:bg-black/40\">\n\n                <NuxtLink :to=\"`/${product.slug}/${product.id}`\"\n                  class=\"bg-cyan-600 text-white  h-8 w-8 flex items-center justify-center rounded-full hover:bg-cyan-600\">\n                  <i class=\"fas fa-search\"></i>\n                </NuxtLink>\n                <button @click=\"addToCart(product)\" :class=\"Number(product.stock) > 0\n                  ? 'bg-cyan-600 h-8 w-8 text-white rounded-full hover:bg-cyan-700'\n                  : 'bg-slate-600 h-8 w-8 text-white rounded-full hover:bg-slate-700 cursor-not-allowed'\"\n                  :disabled=\"Number(product.stock) === 0\">\n                  <i class=\"fas fa-shopping-cart\"></i>\n                </button>\n              </div>\n            </div>\n            <div class=\"p-4 text-center\">\n              <h2 class=\"text-md font-semibold text-gray-800 truncate\">{{ product.name }}</h2>\n              <p class=\"text-sm text-gray-500 font-semibold\">stoc: {{ product.stock }}</p>\n              <p class=\"text-sm text-gray-500 font-semibold\">{{ product.price }} Ron</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nconst cart = useCartStore()\nconst config = useRuntimeConfig()\nconst parentCategories = ref([])\nconst error = ref(null)\n\nconst productStore = useProductStore()\n\nonMounted(async () => {\n  try {\n    const res = await $fetch(`${config.public.apiBase}/parent-categories`);\n    if (Array.isArray(res)) {\n      parentCategories.value = res;\n    } else if (res && Array.isArray(res.data)) {\n      parentCategories.value = res.data;\n    } else {\n      parentCategories.value = [];\n    }\n    console.log('Parent categories:', parentCategories.value);\n  } catch (err) {\n    console.error('Error fetching parent categories:', err);\n    error.value = 'Eroare la încărcarea categoriilor.';\n  }\n})\n\nconst selectedCategories = ref([])\nconst search = ref('')\nconst maxPrice = ref(0)\nconst showFilters = ref(true)\n\nconst filteredProducts = computed(() => {\n  return productStore.items.filter(p => {\n    const matchSearch = p.name.toLowerCase().includes(search.value.toLowerCase())\n    const matchPrice = maxPrice.value > 0 ? Number(p.price) <= maxPrice.value : true\n    const matchCategory =\n      selectedCategories.value.length === 0 ||\n      p.categories?.some(cat => selectedCategories.value.includes(cat.id))\n    return matchSearch && matchPrice && matchCategory\n  })\n})\n\nfunction getImage(product) {\n  return product.image_url\n    ? `${config.public.apiBase}/${product.image_url}`\n    : ''\n}\n\nfunction addToCart(product) {\n  cart.add(product)\n}\n\nfunction resetFilters() {\n  search.value = ''\n  maxPrice.value = 0\n  selectedCategories.value = []\n}\n\nuseHead({\n  title: 'Produse - Hidroserv',\n  meta: [\n    {\n      name: 'description',\n      content: 'Vezi lista de produse oferite de Hidroserv Reparatii Capital SRL.'\n    }\n  ]\n})\n</script>\n\n<style scoped></style>"],"names":[],"mappings":";;;;;;;;;;;AAoHa,iBAAY;AACzB,UAAM,SAAS,iBAAgB;AAC/B,UAAM,mBAAmB,IAAI,CAAE,CAAA;AAC/B,UAAM,QAAQ,IAAI,IAAI;AAEtB,UAAM,eAAe,gBAAe;AAmBpC,UAAM,qBAAqB,IAAI,CAAE,CAAA;AACjC,UAAM,SAAS,IAAI,EAAE;AACrB,UAAM,WAAW,IAAI,CAAC;AACtB,UAAM,cAAc,IAAI,IAAI;AAE5B,UAAM,mBAAmB,SAAS,MAAM;AACtC,aAAO,aAAa,MAAM,OAAO,OAAK;;AACpC,cAAM,cAAc,EAAE,KAAK,YAAa,EAAC,SAAS,OAAO,MAAM,YAAa,CAAA;AAC5E,cAAM,aAAa,SAAS,QAAQ,IAAI,OAAO,EAAE,KAAK,KAAK,SAAS,QAAQ;AAC5E,cAAM,gBACJ,mBAAmB,MAAM,WAAW,OACpC,OAAE,eAAF,mBAAc,KAAK,SAAO,mBAAmB,MAAM,SAAS,IAAI,EAAE;AACpE,eAAO,eAAe,cAAc;AAAA,MACrC,CAAA;AAAA,IACH,CAAC;AAED,aAAS,SAAS,SAAS;AACzB,aAAO,QAAQ,YACX,GAAG,OAAO,OAAO,OAAO,IAAI,QAAQ,SAAS,KAC7C;AAAA,IACN;AAYA,YAAQ;AAAA,MACN,OAAO;AAAA,MACP,MAAM;AAAA,QACJ;AAAA,UACE,MAAM;AAAA,UACN,SAAS;AAAA,QACf;AAAA,MACA;AAAA,IACA,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}